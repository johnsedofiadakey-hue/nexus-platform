{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/nexus-platform/src/proxy.ts"],"sourcesContent":["import { withAuth } from \"next-auth/middleware\";\nimport { NextResponse } from \"next/server\";\n\nexport default withAuth(\n  function middleware(req) {\n    const token = req.nextauth.token;\n    \n    // Allow through if authenticated\n    if (token) {\n      console.log(`[Proxy] Authenticated: ${req.nextUrl.pathname} | Role: ${token.role}`);\n      return NextResponse.next();\n    }\n    \n    // Not authenticated - let NextAuth handle the redirect\n    console.log(`[Proxy] Unauthorized access to: ${req.nextUrl.pathname}`);\n    return NextResponse.next();\n  },\n  {\n    callbacks: {\n      authorized: ({ token, req }) => {\n        // Allow access if token exists\n        if (token) return true;\n        \n        // For API routes, return false immediately (no redirect loop)\n        if (req.nextUrl.pathname.startsWith('/api/')) {\n          return false;\n        }\n        \n        // For pages, allow NextAuth to handle redirect\n        return false;\n      },\n    },\n    pages: {\n      signIn: '/auth/signin',\n    },\n  }\n);\n\n// Only run on dashboard and mobile routes\nexport const config = {\n  matcher: [\"/dashboard/:path*\", \"/mobilepos/:path*\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;uCAEe,IAAA,sJAAQ,EACrB,SAAS,WAAW,GAAG;IACrB,MAAM,QAAQ,IAAI,QAAQ,CAAC,KAAK;IAEhC,iCAAiC;IACjC,IAAI,OAAO;QACT,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,IAAI,OAAO,CAAC,QAAQ,CAAC,SAAS,EAAE,MAAM,IAAI,EAAE;QAClF,OAAO,6QAAY,CAAC,IAAI;IAC1B;IAEA,uDAAuD;IACvD,QAAQ,GAAG,CAAC,CAAC,gCAAgC,EAAE,IAAI,OAAO,CAAC,QAAQ,EAAE;IACrE,OAAO,6QAAY,CAAC,IAAI;AAC1B,GACA;IACE,WAAW;QACT,YAAY,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE;YACzB,+BAA+B;YAC/B,IAAI,OAAO,OAAO;YAElB,8DAA8D;YAC9D,IAAI,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,UAAU;gBAC5C,OAAO;YACT;YAEA,+CAA+C;YAC/C,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;AACF;AAIK,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;KAAoB;AACrD"}}]
}