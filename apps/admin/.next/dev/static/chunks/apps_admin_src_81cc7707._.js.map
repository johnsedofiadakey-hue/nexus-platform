{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/nexus-platform/apps/admin/src/context/ThemeContext.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState } from 'react';\n\ninterface ThemeSettings {\n    primaryColor: string;\n    secondaryColor: string;\n    accentColor: string;\n    logoUrl?: string | null;\n    name?: string;\n}\n\nconst defaultTheme: ThemeSettings = {\n    primaryColor: '#2563EB', // Blue 600\n    secondaryColor: '#0F172A', // Slate 900\n    accentColor: '#F59E0B', // Amber 500\n    name: 'Nexus Command'\n};\n\nconst ThemeContext = createContext<{\n    theme: ThemeSettings;\n    updateTheme: (newTheme: Partial<ThemeSettings>) => void;\n    refreshTheme: () => Promise<void>;\n}>({\n    theme: defaultTheme,\n    updateTheme: () => { },\n    refreshTheme: async () => { }\n});\n\nexport const ThemeProvider = ({ children }: { children: React.ReactNode }) => {\n    const [theme, setTheme] = useState<ThemeSettings>(defaultTheme);\n\n    const refreshTheme = async () => {\n        try {\n            const res = await fetch('/api/settings');\n            if (res.ok) {\n                const data = await res.json();\n                const serverTheme = {\n                    primaryColor: data.primaryColor || defaultTheme.primaryColor,\n                    secondaryColor: data.secondaryColor || defaultTheme.secondaryColor,\n                    accentColor: data.accentColor || defaultTheme.accentColor,\n                    logoUrl: data.logoUrl,\n                    name: data.name\n                };\n                setTheme(serverTheme);\n                applyTheme(serverTheme);\n            }\n        } catch (e) {\n            console.error(\"Theme fetch failed\", e);\n        }\n    };\n\n    const updateTheme = (newSettings: Partial<ThemeSettings>) => {\n        setTheme(prev => {\n            const next = { ...prev, ...newSettings };\n            applyTheme(next);\n            return next;\n        });\n    };\n\n    const applyTheme = (t: ThemeSettings) => {\n        const root = document.documentElement;\n        root.style.setProperty('--color-primary', t.primaryColor);\n        root.style.setProperty('--color-secondary', t.secondaryColor);\n        root.style.setProperty('--color-accent', t.accentColor);\n        // Add RGB variants for opacity usage if needed, but mostly hex is fine if we use style={...}\n    };\n\n    useEffect(() => {\n        refreshTheme();\n    }, []);\n\n    return (\n        <ThemeContext.Provider value={{ theme, updateTheme, refreshTheme }}>\n            {children}\n        </ThemeContext.Provider>\n    );\n};\n\nexport const useTheme = () => useContext(ThemeContext);\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAYA,MAAM,eAA8B;IAChC,cAAc;IACd,gBAAgB;IAChB,aAAa;IACb,MAAM;AACV;AAEA,MAAM,6BAAe,IAAA,6SAAa,EAI/B;IACC,OAAO;IACP,aAAa,KAAQ;IACrB,cAAc,WAAc;AAChC;AAEO,MAAM,gBAAgB,CAAC,EAAE,QAAQ,EAAiC;;IACrE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,wSAAQ,EAAgB;IAElD,MAAM,eAAe;QACjB,IAAI;YACA,MAAM,MAAM,MAAM,MAAM;YACxB,IAAI,IAAI,EAAE,EAAE;gBACR,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,MAAM,cAAc;oBAChB,cAAc,KAAK,YAAY,IAAI,aAAa,YAAY;oBAC5D,gBAAgB,KAAK,cAAc,IAAI,aAAa,cAAc;oBAClE,aAAa,KAAK,WAAW,IAAI,aAAa,WAAW;oBACzD,SAAS,KAAK,OAAO;oBACrB,MAAM,KAAK,IAAI;gBACnB;gBACA,SAAS;gBACT,WAAW;YACf;QACJ,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,sBAAsB;QACxC;IACJ;IAEA,MAAM,cAAc,CAAC;QACjB,SAAS,CAAA;YACL,MAAM,OAAO;gBAAE,GAAG,IAAI;gBAAE,GAAG,WAAW;YAAC;YACvC,WAAW;YACX,OAAO;QACX;IACJ;IAEA,MAAM,aAAa,CAAC;QAChB,MAAM,OAAO,SAAS,eAAe;QACrC,KAAK,KAAK,CAAC,WAAW,CAAC,mBAAmB,EAAE,YAAY;QACxD,KAAK,KAAK,CAAC,WAAW,CAAC,qBAAqB,EAAE,cAAc;QAC5D,KAAK,KAAK,CAAC,WAAW,CAAC,kBAAkB,EAAE,WAAW;IACtD,6FAA6F;IACjG;IAEA,IAAA,ySAAS;mCAAC;YACN;QACJ;kCAAG,EAAE;IAEL,qBACI,4TAAC,aAAa,QAAQ;QAAC,OAAO;YAAE;YAAO;YAAa;QAAa;kBAC5D;;;;;;AAGb;GAhDa;KAAA;AAkDN,MAAM,WAAW;;IAAM,OAAA,IAAA,0SAAU,EAAC;AAAY;IAAxC"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/nexus-platform/apps/admin/src/components/notifications/NotificationBell.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef } from 'react';\nimport { Bell, AlertTriangle, Zap, Ghost, X, CheckCircle } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ntype Alert = {\n    id: string;\n    type: \"GHOST_ALERT\" | \"STOCK_LOW\" | \"BIG_SALE\";\n    user: string;\n    shop: string;\n    message: string;\n    severity: \"HIGH\" | \"MEDIUM\" | \"POSITIVE\";\n    timestamp: string;\n};\n\nexport default function NotificationBell() {\n    const [alerts, setAlerts] = useState<Alert[]>([]);\n    const [isOpen, setIsOpen] = useState(false);\n    const [hasNew, setHasNew] = useState(false);\n    const menuRef = useRef<HTMLDivElement>(null);\n\n    // Poll for alerts every 30s\n    useEffect(() => {\n        const fetchAlerts = async () => {\n            try {\n                const res = await fetch('/api/operations/pulse-feed?t=' + Date.now());\n                const data = await res.json();\n                if (Array.isArray(data)) {\n                    // Check if data changed to trigger \"red dot\"\n                    if (JSON.stringify(data) !== JSON.stringify(alerts)) {\n                        setAlerts(data);\n                        if (data.length > 0) setHasNew(true);\n                    }\n                }\n            } catch (e) {\n                console.error(\"Pulse Sync Failed\", e);\n            }\n        };\n\n        fetchAlerts();\n        const interval = setInterval(fetchAlerts, 30000);\n        return () => clearInterval(interval);\n    }, []);\n\n    // Close when clicking outside\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n                setIsOpen(false);\n            }\n        };\n        document.addEventListener(\"mousedown\", handleClickOutside);\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n    }, [menuRef]);\n\n    const getIcon = (type: string) => {\n        switch (type) {\n            case 'GHOST_ALERT': return <Ghost className=\"w-5 h-5 text-slate-500\" />;\n            case 'STOCK_LOW': return <AlertTriangle className=\"w-5 h-5 text-amber-500\" />;\n            case 'BIG_SALE': return <Zap className=\"w-5 h-5 text-blue-500\" />;\n            default: return <Bell className=\"w-5 h-5 text-slate-400\" />;\n        }\n    };\n\n    return (\n        <div className=\"relative\" ref={menuRef}>\n            <button\n                onClick={() => { setIsOpen(!isOpen); setHasNew(false); }}\n                className=\"relative p-2 rounded-xl hover:bg-slate-100 transition-colors\"\n            >\n                <Bell className={`w-5 h-5 ${hasNew ? 'text-slate-900' : 'text-slate-400'}`} />\n                {hasNew && (\n                    <span className=\"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border border-white animate-pulse\" />\n                )}\n            </button>\n\n            <AnimatePresence>\n                {isOpen && (\n                    <motion.div\n                        initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\n                        exit={{ opacity: 0, y: 10, scale: 0.95 }}\n                        className=\"absolute right-0 mt-2 w-80 bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden z-50 origin-top-right\"\n                    >\n                        <div className=\"p-4 border-b border-slate-50 flex justify-between items-center bg-slate-50/50\">\n                            <h3 className=\"text-xs font-black uppercase tracking-widest text-slate-500\">Notifications</h3>\n                            <span className=\"text-[10px] font-bold bg-slate-200 text-slate-600 px-2 py-0.5 rounded-full\">{alerts.length}</span>\n                        </div>\n\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {alerts.length === 0 ? (\n                                <div className=\"p-8 text-center text-slate-400\">\n                                    <CheckCircle className=\"w-8 h-8 mx-auto mb-2 opacity-20\" />\n                                    <p className=\"text-xs font-medium\">All caught up!</p>\n                                </div>\n                            ) : (\n                                alerts.map((alert) => (\n                                    <div key={alert.id} className=\"p-4 border-b border-slate-50 hover:bg-slate-50 transition-colors flex gap-3\">\n                                        <div className={`mt-1 p-2 rounded-lg h-fit ${alert.severity === 'HIGH' ? 'bg-red-50' :\n                                                alert.severity === 'POSITIVE' ? 'bg-blue-50' : 'bg-amber-50'\n                                            }`}>\n                                            {getIcon(alert.type)}\n                                        </div>\n                                        <div>\n                                            <p className=\"text-xs font-bold text-slate-900\">{alert.message}</p>\n                                            <div className=\"flex items-center gap-2 mt-1\">\n                                                <span className=\"text-[10px] font-medium text-slate-500\">{alert.shop}</span>\n                                                <span className=\"text-[10px] text-slate-300\">‚Ä¢</span>\n                                                <span className=\"text-[10px] font-medium text-slate-400\">{alert.user}</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                ))\n                            )}\n                        </div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/nexus-platform/apps/admin/src/components/CommandPalette.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { Command } from \"cmdk\";\nimport { useRouter } from \"next/navigation\";\nimport {\n    LayoutDashboard, Users, ShoppingBag,\n    Settings, Building2, Plus, Search,\n    FileText, ShieldCheck\n} from \"lucide-react\";\n\nexport default function CommandPalette() {\n    const [open, setOpen] = useState(false);\n    const router = useRouter();\n\n    useEffect(() => {\n        const down = (e: KeyboardEvent) => {\n            if (e.key === \"k\" && (e.metaKey || e.ctrlKey)) {\n                e.preventDefault();\n                setOpen((open) => !open);\n            }\n        };\n        document.addEventListener(\"keydown\", down);\n        return () => document.removeEventListener(\"keydown\", down);\n    }, []);\n\n    const runCommand = (command: () => void) => {\n        setOpen(false);\n        command();\n    };\n\n    if (!open) return null;\n\n    return (\n        <div className=\"fixed inset-0 z-[100] bg-slate-900/50 backdrop-blur-sm flex items-start justify-center pt-[20vh] animate-in fade-in duration-200\">\n            <Command className=\"w-full max-w-2xl bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden\">\n                <div className=\"flex items-center px-4 border-b border-slate-100\">\n                    <Search className=\"w-5 h-5 text-slate-400 mr-2\" />\n                    <Command.Input\n                        placeholder=\"Type a command or search...\"\n                        className=\"w-full h-16 outline-none text-lg font-medium text-slate-900 placeholder:text-slate-400\"\n                    />\n                </div>\n\n                <Command.List className=\"max-h-[300px] overflow-y-auto p-2\">\n                    <Command.Empty className=\"py-6 text-center text-slate-500 text-sm font-medium\">\n                        No results found.\n                    </Command.Empty>\n\n                    <Command.Group heading=\"Navigation\" className=\"px-2 py-1.5 text-xs font-black text-slate-400 uppercase tracking-widest mb-1\">\n                        <Item icon={LayoutDashboard} onSelect={() => runCommand(() => router.push(\"/dashboard\"))}>Overview</Item>\n                        <Item icon={Building2} onSelect={() => runCommand(() => router.push(\"/dashboard/shops\"))}>Shops</Item>\n                        <Item icon={Users} onSelect={() => runCommand(() => router.push(\"/dashboard/hr\"))}>Team</Item>\n                        <Item icon={ShoppingBag} onSelect={() => runCommand(() => router.push(\"/dashboard/inventory\"))}>Inventory</Item>\n                        <Item icon={Settings} onSelect={() => runCommand(() => router.push(\"/dashboard/settings\"))}>Settings</Item>\n                    </Command.Group>\n\n                    <Command.Group heading=\"Actions\" className=\"px-2 py-1.5 text-xs font-black text-slate-400 uppercase tracking-widest mb-1 mt-2\">\n                        <Item icon={Plus} onSelect={() => runCommand(() => router.push(\"/dashboard/shops?new=true\"))}>Add New Shop</Item>\n                        <Item icon={Plus} onSelect={() => runCommand(() => router.push(\"/dashboard/hr?new=true\"))}>Add Staff Member</Item>\n                        <Item icon={FileText} onSelect={() => runCommand(() => router.push(\"/dashboard/sales\"))}>View Sales Register</Item>\n                        <Item icon={ShieldCheck} onSelect={() => runCommand(() => router.push(\"/dashboard/settings/audit\"))}>View Audit Logs</Item>\n                    </Command.Group>\n                </Command.List>\n            </Command>\n        </div>\n    );\n}\n\nfunction Item({ children, icon: Icon, onSelect }: { children: React.ReactNode, icon: any, onSelect: () => void }) {\n    return (\n        <Command.Item\n            onSelect={onSelect}\n            className=\"flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-slate-600 cursor-pointer hover:bg-slate-100 hover:text-slate-900 transition-colors aria-selected:bg-slate-100 aria-selected:text-slate-900\"\n        >\n            <Icon className=\"w-4 h-4 text-slate-400\" />\n            {children}\n        </Command.Item>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AALA;;;;;AAWe,SAAS;;IACpB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wSAAQ,EAAC;IACjC,MAAM,SAAS,IAAA,iRAAS;IAExB,IAAA,ySAAS;oCAAC;YACN,MAAM;iDAAO,CAAC;oBACV,IAAI,EAAE,GAAG,KAAK,OAAO,CAAC,EAAE,OAAO,IAAI,EAAE,OAAO,GAAG;wBAC3C,EAAE,cAAc;wBAChB;6DAAQ,CAAC,OAAS,CAAC;;oBACvB;gBACJ;;YACA,SAAS,gBAAgB,CAAC,WAAW;YACrC;4CAAO,IAAM,SAAS,mBAAmB,CAAC,WAAW;;QACzD;mCAAG,EAAE;IAEL,MAAM,aAAa,CAAC;QAChB,QAAQ;QACR;IACJ;IAEA,IAAI,CAAC,MAAM,OAAO;IAElB,qBACI,4TAAC;QAAI,WAAU;kBACX,cAAA,4TAAC,gXAAO;YAAC,WAAU;;8BACf,4TAAC;oBAAI,WAAU;;sCACX,4TAAC,uSAAM;4BAAC,WAAU;;;;;;sCAClB,4TAAC,gXAAO,CAAC,KAAK;4BACV,aAAY;4BACZ,WAAU;;;;;;;;;;;;8BAIlB,4TAAC,gXAAO,CAAC,IAAI;oBAAC,WAAU;;sCACpB,4TAAC,gXAAO,CAAC,KAAK;4BAAC,WAAU;sCAAsD;;;;;;sCAI/E,4TAAC,gXAAO,CAAC,KAAK;4BAAC,SAAQ;4BAAa,WAAU;;8CAC1C,4TAAC;oCAAK,MAAM,sUAAe;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAAgB;;;;;;8CAC1F,4TAAC;oCAAK,MAAM,oTAAS;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAAsB;;;;;;8CAC1F,4TAAC;oCAAK,MAAM,oSAAK;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAAmB;;;;;;8CACnF,4TAAC;oCAAK,MAAM,0TAAW;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAA0B;;;;;;8CAChG,4TAAC;oCAAK,MAAM,6SAAQ;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAAyB;;;;;;;;;;;;sCAGhG,4TAAC,gXAAO,CAAC,KAAK;4BAAC,SAAQ;4BAAU,WAAU;;8CACvC,4TAAC;oCAAK,MAAM,iSAAI;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAA+B;;;;;;8CAC9F,4TAAC;oCAAK,MAAM,iSAAI;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAA4B;;;;;;8CAC3F,4TAAC;oCAAK,MAAM,iTAAQ;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAAsB;;;;;;8CACzF,4TAAC;oCAAK,MAAM,0TAAW;oCAAE,UAAU,IAAM,WAAW,IAAM,OAAO,IAAI,CAAC;8CAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM7H;GAxDwB;;QAEL,iRAAS;;;KAFJ;AA0DxB,SAAS,KAAK,EAAE,QAAQ,EAAE,MAAM,IAAI,EAAE,QAAQ,EAAkE;IAC5G,qBACI,4TAAC,gXAAO,CAAC,IAAI;QACT,UAAU;QACV,WAAU;;0BAEV,4TAAC;gBAAK,WAAU;;;;;;YACf;;;;;;;AAGb;MAVS"}},
    {"offset": {"line": 653, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/nexus-platform/apps/admin/src/app/dashboard/layout.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useSession, signOut } from \"next-auth/react\"; // SessionProvider removed (it's in root layout now)\nimport Link from \"next/link\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport {\n  LayoutDashboard, Users, ShoppingBag, LogOut,\n  ShieldCheck, Menu, Building2, ChevronRight,\n  MessageSquare, Loader2, Bell, Settings, RefreshCw, FileText\n} from \"lucide-react\";\nimport { ThemeProvider, useTheme } from \"@/context/ThemeContext\";\nimport NotificationBell from \"@/components/notifications/NotificationBell\";\nimport CommandPalette from \"@/components/CommandPalette\";\n\n// üöÄ NAVIGATION MAP\nconst navItems = [\n  { icon: LayoutDashboard, label: \"Overview\", path: \"/dashboard\" },\n  { icon: Building2, label: \"Stores\", path: \"/dashboard/shops\" },\n  { icon: Users, label: \"Team\", path: \"/dashboard/hr\" },\n  { icon: ShoppingBag, label: \"Inventory\", path: \"/dashboard/inventory\" },\n  { icon: FileText, label: \"Sales Register\", path: \"/dashboard/sales\" },\n  { icon: ShieldCheck, label: \"Master Activity Log\", path: \"/dashboard/admin\" }, // üÜï RENAMED\n  { icon: Settings, label: \"Settings\", path: \"/dashboard/settings\" },\n];\n\nfunction DashboardContent({ children }: { children: React.ReactNode }) {\n  const { theme } = useTheme();\n  const { data: session, status: authStatus } = useSession();\n  const pathname = usePathname();\n  const router = useRouter();\n\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\n  const [navigatingTo, setNavigatingTo] = useState<string | null>(null);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  // 1. üõ°Ô∏è AUTH GUARD: Redirect logic must be inside useEffect to prevent render crashes\n  useEffect(() => {\n    if (authStatus === \"unauthenticated\") {\n      // Store the current path to return after login\n      const returnUrl = pathname !== \"/dashboard\" ? pathname : \"/dashboard\";\n      router.push(`/auth/signin?callbackUrl=${encodeURIComponent(returnUrl)}`);\n    }\n  }, [authStatus, router, pathname]);\n\n  // 2. üßπ NAVIGATION CLEANUP: Close sidebar on mobile when route changes\n  useEffect(() => {\n    setNavigatingTo(null);\n    setSidebarOpen(false);\n  }, [pathname]);\n\n  const handleRefresh = () => {\n    setIsRefreshing(true);\n    router.refresh();\n    setTimeout(() => setIsRefreshing(false), 800);\n  };\n\n  // 3. ‚è≥ LOADING STATE: Show a clean spinner while checking session\n  if (authStatus === \"loading\" || authStatus === \"unauthenticated\") {\n    return (\n      <div className=\"min-h-screen bg-slate-50 flex items-center justify-center\">\n        <div className=\"flex flex-col items-center gap-4\">\n          <Loader2 className=\"w-8 h-8 text-primary animate-spin\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-slate-50 text-slate-900 font-sans\">\n      <CommandPalette />\n      {/* MOBILE OVERLAY */}\n      {isSidebarOpen && (\n        <div\n          className=\"fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-[60] lg:hidden transition-opacity duration-300\"\n          onClick={() => setSidebarOpen(false)}\n        />\n      )}\n\n      {/* --- SIDEBAR --- */}\n      <aside className={`fixed inset-y-0 left-0 z-[70] w-72 bg-white border-r border-slate-200 transform transition-transform duration-300 cubic-bezier(0.4, 0, 0.2, 1) lg:relative lg:translate-x-0 ${isSidebarOpen ? \"translate-x-0\" : \"-translate-x-full\"}`}>\n        <div className=\"flex flex-col h-full\">\n\n          {/* BRANDING */}\n          <div className=\"h-20 flex items-center px-8 border-b border-slate-100\">\n            <div className=\"flex items-center gap-3\">\n              <div\n                className=\"w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold shadow-lg shadow-primary/20\"\n                style={{ backgroundColor: theme.primaryColor || '#0f172a' }}\n              >\n                {theme.logoUrl ? (\n                  // eslint-disable-next-line @next/next/no-img-element\n                  <img src={theme.logoUrl} alt=\"Logo\" className=\"w-5 h-5 object-contain\" />\n                ) : (\n                  <ShieldCheck className=\"w-5 h-5\" />\n                )}\n              </div>\n              <div>\n                <span className=\"font-bold text-base text-slate-900 block leading-none\">{theme.name || 'NEXUS'}</span>\n                <span className=\"text-[10px] font-semibold text-slate-400 uppercase tracking-wider mt-0.5 block\">Enterprise</span>\n              </div>\n            </div>\n          </div>\n\n          {/* NAVIGATION */}\n          <nav className=\"flex-1 px-4 py-8 space-y-1\">\n            <p className=\"px-4 pb-2 text-[10px] font-bold text-slate-400 uppercase tracking-widest\">Platform</p>\n            {navItems.map((item) => {\n              const isActive = pathname === item.path || (item.path !== '/dashboard' && pathname.startsWith(item.path));\n              return (\n                <Link\n                  key={item.path}\n                  href={item.path}\n                  onClick={() => { if (pathname !== item.path) setNavigatingTo(item.path) }}\n                  // Dynamic Active State\n                  className={`relative flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 ${isActive\n                    ? \"bg-slate-900/5 text-slate-900\"\n                    : \"text-slate-500 hover:bg-slate-50 hover:text-slate-900\"\n                    }`}\n                >\n                  <item.icon className={`w-4 h-4 transition-colors ${isActive ? 'text-primary' : 'text-slate-400'}`} />\n                  {item.label}\n                  {item.label === \"Inventory\" && <span className=\"ml-auto w-2 h-2 rounded-full bg-rose-500\"></span>}\n                  {navigatingTo === item.path && <Loader2 className=\"absolute right-4 w-3.5 h-3.5 animate-spin text-slate-400\" />}\n                </Link>\n              );\n            })}\n          </nav>\n\n          {/* EXIT STRATEGY */}\n          <div className=\"p-4 border-t border-slate-100\">\n            <button\n              onClick={() => signOut()}\n              className=\"w-full flex items-center justify-center gap-2 py-2.5 rounded-lg text-xs font-semibold text-slate-500 hover:text-rose-600 hover:bg-rose-50 transition-colors\"\n            >\n              <LogOut className=\"w-3.5 h-3.5\" />\n              Sign Out\n            </button>\n          </div>\n        </div>\n      </aside>\n\n      {/* --- PRIMARY WORKSPACE --- */}\n      <div className=\"flex-1 flex flex-col min-w-0 h-screen overflow-hidden\">\n\n        {/* HEADER */}\n        <header className=\"h-16 bg-white/80 backdrop-blur-md border-b border-slate-200/60 flex items-center justify-between px-8 z-20 sticky top-0\">\n          <div className=\"flex items-center gap-4\">\n            <button className=\"lg:hidden p-2 hover:bg-slate-100 rounded-lg transition-colors\" onClick={() => setSidebarOpen(true)}>\n              <Menu className=\"w-5 h-5 text-slate-600\" />\n            </button>\n\n            {/* Breadcrumbs */}\n            <div className=\"flex items-center gap-2 text-xs font-medium text-slate-500\">\n              <span className=\"hover:text-slate-900 cursor-pointer transition-colors\">Nexus</span>\n              <ChevronRight className=\"w-3.5 h-3.5 text-slate-300\" />\n              <span className=\"text-slate-900 capitalize\">{pathname.split('/').pop()?.replace(/-/g, ' ') || 'Overview'}</span>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={handleRefresh}\n              className={`flex items-center gap-2 px-3 py-1.5 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 transition-all active:scale-95 group/refresh ${isRefreshing ? 'opacity-70 cursor-wait' : ''}`}\n              title=\"Refresh Global Data\"\n            >\n              <RefreshCw className={`w-3.5 h-3.5 text-slate-400 group-hover/refresh:text-primary transition-colors ${isRefreshing ? 'animate-spin text-primary' : ''}`} />\n              <span className=\"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover/refresh:text-slate-900\">\n                {isRefreshing ? 'Refreshing...' : 'Sync'}\n              </span>\n            </button>\n\n            <div className=\"h-6 w-px bg-slate-200 mx-1\"></div>\n\n            {/* Dynamic System Status */}\n            <div className=\"hidden md:flex items-center gap-2 px-3 py-1.5 bg-slate-900/5 rounded-full border border-slate-900/5\">\n              <div className=\"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse\"></div>\n              <span className=\"text-[10px] font-bold uppercase tracking-wider text-slate-600\">Secure</span>\n            </div>\n\n            <div className=\"h-8 w-px bg-slate-200\"></div>\n\n            <NotificationBell />\n          </div>\n        </header>\n\n        {/* CONTENT */}\n        <main className=\"flex-1 overflow-y-auto p-8 scroll-smooth\">\n          <div className=\"max-w-7xl mx-auto w-full animate-in fade-in slide-in-from-bottom-4 duration-500\">\n            {children}\n          </div>\n        </main>\n      </div>\n    </div>\n  );\n}\n\nexport default function DashboardLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <ThemeProvider>\n      <DashboardContent>{children}</DashboardContent>\n    </ThemeProvider>\n  );\n}"],"names":[],"mappings":"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"}}]
}