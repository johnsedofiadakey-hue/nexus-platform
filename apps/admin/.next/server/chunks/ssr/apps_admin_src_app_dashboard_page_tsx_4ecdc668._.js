module.exports=[40572,a=>{"use strict";var b=a.i(89477),c=a.i(89930),d=a.i(56957),e=a.i(26806),f=a.i(69065),g=a.i(25700);let h=(0,g.default)("signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);var i=a.i(44981),j=a.i(21084),k=a.i(9359),l=a.i(71306),m=a.i(94837);let n=(0,g.default)("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var o=a.i(88064),p=a.i(51093),q=a.i(65073),r=a.i(98055),s=a.i(7996),t=a.i(72336),u=a.i(77991),v=a.i(21486),w=a.i(30439),x=a.i(57399),y=a.i(78301),z=a.i(11400);let A=(0,g.default)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var B=a.i(62147),C=a.i(72980),D=a.i(75263),E=a.i(77241),F=a.i(46168);function G({data:a}){return(0,b.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,b.jsx)("div",{className:"px-5 py-3 border-b border-slate-200 bg-slate-50 sticky top-0 z-10",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(i.Activity,{size:14,className:"text-blue-600"}),(0,b.jsx)("div",{className:"absolute -top-1 -right-1 w-1.5 h-1.5 bg-blue-500 rounded-full animate-ping"})]}),(0,b.jsx)("h3",{className:"text-xs font-semibold text-slate-900",children:"Activity Pulse"})]}),(0,b.jsx)("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider",children:"Live"})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 space-y-3",children:a.length>0?a.map(a=>{var c;let d;return(0,b.jsxs)("div",{className:"flex gap-3 group",children:[(0,b.jsxs)("div",{className:"relative flex flex-col items-center",children:[(0,b.jsx)("div",{className:`p-1.5 border transition-all ${"HIGH"===a.severity?"bg-rose-50 border-rose-200":"POSITIVE"===a.severity?"bg-emerald-50 border-emerald-200":"bg-slate-50 border-slate-200"}`,children:((a,c)=>{switch(a){case"SALE_EVENT":return(0,b.jsx)(z.ShoppingCart,{size:14,className:"POSITIVE"===c?"text-emerald-500":"text-blue-500"});case"CHECK_IN":return(0,b.jsx)(A,{size:14,className:"text-indigo-500"});case"FIELD_REPORT":return(0,b.jsx)(B.FileText,{size:14,className:"text-amber-500"});case"GHOST_ALERT":return(0,b.jsx)(C.AlertCircle,{size:14,className:"text-rose-500"});case"STOCK_LOW":return(0,b.jsx)(C.AlertCircle,{size:14,className:"text-orange-500"});default:return(0,b.jsx)(i.Activity,{size:14,className:"text-slate-400"})}})(a.type,a.severity)}),(0,b.jsx)("div",{className:"w-px flex-1 bg-slate-200 mt-2"})]}),(0,b.jsxs)("div",{className:"flex-1 pb-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold text-slate-900 leading-tight",children:a.user}),(0,b.jsxs)("span",{className:"text-[9px] font-medium text-slate-400 leading-tight flex items-center gap-1",children:[(0,b.jsx)(F.Clock,{size:9})," ",(c=a.timestamp,(d=Math.floor((new Date().getTime()-new Date(c).getTime())/1e3))<60?"Just now":d<3600?`${Math.floor(d/60)}m ago`:`${Math.floor(d/3600)}h ago`)]})]}),(0,b.jsx)("p",{className:"text-xs text-slate-600 mb-2 pr-4",children:a.message}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-[9px] font-medium text-slate-500 uppercase tracking-wider",children:[(0,b.jsx)(E.MapPin,{size:9})," ",a.shop]}),"SALE_EVENT"===a.type&&"POSITIVE"===a.severity&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-[9px] font-medium text-emerald-700 bg-emerald-50 border border-emerald-200 px-1.5 py-0.5",children:[(0,b.jsx)(D.TrendingUp,{size:9})," High Value"]})]})]})]},a.id)}):(0,b.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center p-8",children:[(0,b.jsx)("div",{className:"p-4 bg-slate-50 border border-slate-200 mb-4",children:(0,b.jsx)(i.Activity,{size:20,className:"text-slate-300"})}),(0,b.jsx)("p",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Scanning Network..."}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Acquiring real-time activity stream"})]})})]})}var H=a.i(81781),I=a.i(3410),J=a.i(73921);function K(){let[a,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{let a=async()=>{try{let a=await fetch("/api/activity-log?limit=10"),b=await a.json();b.success&&d(b.data)}catch(a){console.error("Failed to fetch activity log:",a)}finally{f(!1)}};a();let b=setInterval(a,3e4);return()=>clearInterval(b)},[]),(0,b.jsxs)("div",{className:"bg-white border border-slate-200 h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Activity,{size:14,className:"text-slate-600"}),(0,b.jsx)("h3",{className:"text-xs font-bold text-slate-900 uppercase tracking-wide",children:"Recent Activity"})]}),(0,b.jsxs)(J.default,{href:"/dashboard/activity-log",className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:["View All ",(0,b.jsx)(I.ChevronRight,{size:12})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:e?(0,b.jsxs)("div",{className:"p-8 text-center",children:[(0,b.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-slate-200 border-t-slate-600 rounded-full mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Loading..."})]}):a.length>0?(0,b.jsx)("div",{className:"divide-y divide-slate-100",children:a.map(a=>{var c;let d,e;return(0,b.jsx)("div",{className:"px-4 py-3 hover:bg-slate-50 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"pt-0.5",children:(0,b.jsx)("div",{className:"w-7 h-7 rounded bg-slate-100 flex items-center justify-center",children:(0,b.jsx)(H.User,{size:14,className:"text-slate-500"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-900 truncate",children:a.userName}),(0,b.jsx)("span",{className:`px-1.5 py-0.5 rounded text-[9px] font-bold uppercase ${(c=a.action).includes("CREATED")?"text-emerald-600 bg-emerald-50":c.includes("UPDATED")?"text-blue-600 bg-blue-50":c.includes("DELETED")?"text-red-600 bg-red-50":"text-slate-600 bg-slate-50"}`,children:a.action.replace(/_/g," ")})]}),(0,b.jsx)("p",{className:"text-xs text-slate-600 leading-snug line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-[10px] text-slate-400",children:[(0,b.jsx)(F.Clock,{size:10}),(d=new Date(a.createdAt),(e=Math.floor((new Date().getTime()-d.getTime())/6e4))<1?"Just now":e<60?`${e}m ago`:e<1440?`${Math.floor(e/60)}h ago`:d.toLocaleDateString())]})]})]})},a.id)})}):(0,b.jsxs)("div",{className:"p-8 text-center",children:[(0,b.jsx)(i.Activity,{size:32,className:"text-slate-200 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"No recent activity"})]})})]})}var L=a.i(41029),M=a.i(3581),N=a.i(67837),O=a.i(34833),P=a.i(2807),Q=a.i(60942);function R({adminTarget:a,teamPerformance:d,onRefresh:g}){let[h,i]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)({targetValue:a?.targetValue||5e4,targetQuantity:a?.targetQuantity||500,period:"MONTHLY"}),o=a&&d?.totalSales!=null&&a.targetValue?Math.min(d.totalSales/a.targetValue*100,100):0,p=a&&d?.totalQuantity!=null&&a.targetQuantity?Math.min(d.totalQuantity/a.targetQuantity*100,100):0,q=async()=>{l(!0);let b=Q.toast.loading(a?"Updating target...":"Creating target...");try{let c=new Date,d=new Date;"WEEKLY"===m.period?d.setDate(c.getDate()+7):"MONTHLY"===m.period?d.setMonth(c.getMonth()+1):"QUARTERLY"===m.period&&d.setMonth(c.getMonth()+3);let e=a?"PATCH":"POST",f={targetValue:parseFloat(m.targetValue.toString()),targetQuantity:parseInt(m.targetQuantity.toString()),targetType:"ADMIN"};if(a?f.targetId=a.id:(f.startDate=c,f.endDate=d),(await fetch("/api/targets",{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(f)})).ok)Q.toast.success(a?"Target updated successfully":"Target created successfully",{id:b}),i(!1),g();else throw Error("Failed to save target")}catch(a){Q.toast.error("Failed to save target",{id:b})}finally{l(!1)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"bg-white border border-slate-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"border-b border-slate-200 px-5 py-3 bg-slate-50 flex justify-between items-center",children:[(0,b.jsxs)("h3",{className:"text-xs font-semibold text-slate-900 flex items-center gap-2",children:[(0,b.jsx)(L.Target,{size:14,className:"text-indigo-600"})," Team Performance Target"]}),(0,b.jsx)("button",{onClick:()=>{a&&n({targetValue:a.targetValue,targetQuantity:a.targetQuantity,period:"MONTHLY"}),i(!0)},className:"flex items-center gap-1.5 px-3 py-1.5 text-[9px] font-semibold uppercase tracking-wider bg-indigo-600 text-white hover:bg-indigo-700 transition-colors",children:a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(O.Edit2,{size:10})," Edit"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.Plus,{size:10})," Set Target"]})})]}),a?(0,b.jsxs)("div",{className:"p-5 space-y-5",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center pb-3 border-b border-slate-100",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Current Period"}),(0,b.jsxs)("p",{className:"text-xs font-semibold text-slate-900 mt-1",children:[new Date(a.startDate).toLocaleDateString()," - ",new Date(a.endDate).toLocaleDateString()]})]}),(0,b.jsx)("div",{className:`px-2.5 py-1 text-[9px] font-bold uppercase tracking-wider ${"ACTIVE"===a.status?"bg-emerald-50 border border-emerald-200 text-emerald-700":"COMPLETED"===a.status?"bg-blue-50 border border-blue-200 text-blue-700":"bg-slate-50 border border-slate-200 text-slate-700"}`,children:a.status})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"bg-slate-50 border border-slate-200 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 mb-1.5",children:[(0,b.jsx)(f.Users,{size:10,className:"text-slate-500"}),(0,b.jsx)("p",{className:"text-[9px] font-semibold text-slate-500 uppercase tracking-wider",children:"Active Agents"})]}),(0,b.jsx)("p",{className:"text-xl font-bold text-slate-900",children:d.activeAgents})]}),(0,b.jsxs)("div",{className:"bg-slate-50 border border-slate-200 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 mb-1.5",children:[(0,b.jsx)(M.DollarSign,{size:10,className:"text-emerald-600"}),(0,b.jsx)("p",{className:"text-[9px] font-semibold text-slate-500 uppercase tracking-wider",children:"Team Sales"})]}),(0,b.jsxs)("p",{className:"text-xl font-bold text-emerald-600",children:["₵",d.totalSales.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"bg-slate-50 border border-slate-200 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 mb-1.5",children:[(0,b.jsx)(j.Package,{size:10,className:"text-blue-600"}),(0,b.jsx)("p",{className:"text-[9px] font-semibold text-slate-500 uppercase tracking-wider",children:"Units Sold"})]}),(0,b.jsx)("p",{className:"text-xl font-bold text-blue-600",children:d.totalQuantity})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Revenue Target"}),(0,b.jsxs)("p",{className:"text-sm font-bold text-slate-900 mt-0.5",children:["₵",d.totalSales.toLocaleString()," ",(0,b.jsxs)("span",{className:"text-slate-400",children:["/ ₵",a.targetValue.toLocaleString()]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(D.TrendingUp,{size:12,className:o>=100?"text-emerald-600":o>=50?"text-amber-600":"text-slate-400"}),(0,b.jsxs)("p",{className:`text-sm font-bold ${o>=100?"text-emerald-600":o>=50?"text-amber-600":"text-slate-900"}`,children:[(o||0).toFixed(1),"%"]})]})]}),(0,b.jsx)("div",{className:"h-2 bg-slate-100 border border-slate-200 overflow-hidden",children:(0,b.jsx)("div",{className:`h-full transition-all duration-500 ${o>=100?"bg-emerald-500":o>=75?"bg-blue-500":o>=50?"bg-amber-500":"bg-slate-400"}`,style:{width:`${o}%`}})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Volume Target"}),(0,b.jsxs)("p",{className:"text-sm font-bold text-slate-900 mt-0.5",children:[d.totalQuantity," ",(0,b.jsxs)("span",{className:"text-slate-400",children:["/ ",a.targetQuantity," units"]})]})]}),(0,b.jsxs)("p",{className:`text-sm font-bold ${p>=100?"text-emerald-600":p>=50?"text-amber-600":"text-slate-900"}`,children:[(p||0).toFixed(1),"%"]})]}),(0,b.jsx)("div",{className:"h-2 bg-slate-100 border border-slate-200 overflow-hidden",children:(0,b.jsx)("div",{className:`h-full transition-all duration-500 ${p>=100?"bg-emerald-500":p>=75?"bg-blue-500":p>=50?"bg-amber-500":"bg-slate-400"}`,style:{width:`${p}%`}})})]})]}):(0,b.jsxs)("div",{className:"p-12 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 mx-auto bg-slate-50 border border-slate-200 flex items-center justify-center mb-4",children:(0,b.jsx)(L.Target,{size:24,className:"text-slate-300"})}),(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"No Active Target"}),(0,b.jsx)("p",{className:"text-[10px] text-slate-400 mt-1",children:"Set a team performance goal to track progress"})]})]}),h&&(0,b.jsx)("div",{className:"fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white w-full max-w-md border border-slate-200",children:[(0,b.jsxs)("div",{className:"p-8 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-bold text-slate-900",children:[a?"Edit":"Set"," Team Target"]}),(0,b.jsx)("p",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider mt-1",children:"Admin Performance Goal"})]}),(0,b.jsx)("button",{onClick:()=>i(!1),className:"p-2 bg-white border border-slate-200 hover:bg-slate-50 transition-colors",children:(0,b.jsx)(P.X,{size:18})})]}),(0,b.jsxs)("div",{className:"p-8 space-y-5",children:[!a&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Period"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["WEEKLY","MONTHLY","QUARTERLY"].map(a=>(0,b.jsx)("button",{onClick:()=>n({...m,period:a}),className:`py-2.5 text-[10px] font-bold uppercase tracking-wider border transition-colors ${m.period===a?"bg-indigo-600 border-indigo-600 text-white":"bg-slate-50 border-slate-200 text-slate-500 hover:border-slate-300"}`,children:a},a))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Revenue Target (₵)"}),(0,b.jsx)("input",{type:"number",className:"w-full h-12 px-4 bg-slate-50 border border-slate-200 text-sm font-semibold outline-none focus:border-indigo-500 focus:bg-white transition-colors",placeholder:"50000",value:m.targetValue,onChange:a=>n({...m,targetValue:parseFloat(a.target.value)||0})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:"Volume Target (Units)"}),(0,b.jsx)("input",{type:"number",className:"w-full h-12 px-4 bg-slate-50 border border-slate-200 text-sm font-semibold outline-none focus:border-indigo-500 focus:bg-white transition-colors",placeholder:"500",value:m.targetQuantity,onChange:a=>n({...m,targetQuantity:parseInt(a.target.value)||0})})]}),(0,b.jsx)("div",{className:"pt-5 border-t border-slate-200",children:(0,b.jsx)("button",{onClick:q,disabled:k||!m.targetValue||!m.targetQuantity,className:"w-full h-12 bg-slate-900 text-white font-bold uppercase tracking-wider hover:bg-slate-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:k?(0,b.jsx)(e.RefreshCcw,{className:"animate-spin",size:16}):a?"Update Target":"Activate Target"})})]})]})})]})}let S=(0,w.default)(async()=>{},{loadableGenerated:{modules:[9887]},ssr:!1,loading:()=>(0,b.jsxs)("div",{className:"h-full w-full bg-slate-100 animate-pulse rounded-sm flex flex-col items-center justify-center",children:[(0,b.jsx)(e.RefreshCcw,{className:"animate-spin text-slate-300 mb-2",size:20}),(0,b.jsx)("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Calibrating Satellite..."})]})}),T=({label:a,value:c,sub:d,icon:e,active:f,alert:g})=>(0,b.jsxs)("div",{className:`nexus-card p-6 flex flex-col justify-between h-32 ${f?"border-primary bg-primary/5":""} ${g?"border-rose-200 bg-rose-50/10":""}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsx)("div",{className:`p-2.5 rounded-lg ${f?"bg-primary/10 text-primary":g?"bg-rose-100 text-rose-700":"bg-slate-100 text-slate-600"}`,children:(0,b.jsx)(e,{size:18,strokeWidth:2})}),f&&(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary animate-pulse shadow-[0_0_8px_var(--color-primary)]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-semibold text-slate-900 tracking-tight",children:c}),(0,b.jsxs)("div",{className:"flex justify-between items-end mt-0.5",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider",children:a}),d&&(0,b.jsx)("p",{className:"text-[9px] text-slate-400",children:d})]})]})]});function U(){let{data:a,status:g}=(0,x.useSession)(),w=(0,y.useRouter)(),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)({shops:[],team:[],analytics:{},pulse:[],adminTarget:null,teamPerformance:{totalSales:0,totalQuantity:0,activeAgents:0}}),[D,E]=(0,c.useState)("DATA"),[F,H]=(0,c.useState)(!1),I=(0,c.useCallback)(async()=>{if("authenticated"===g)try{let a=Date.now(),b=new AbortController,c=setTimeout(()=>b.abort(),15e3),[d,e,f,g,h,i]=await Promise.all([fetch(`/api/analytics/dashboard?t=${a}`,{signal:b.signal}),fetch(`/api/operations/pulse-feed?t=${a}`,{signal:b.signal}),fetch(`/api/shops/list?t=${a}`,{signal:b.signal}),fetch(`/api/hr/team/list?t=${a}`,{signal:b.signal}),fetch(`/api/targets?targetType=ADMIN&t=${a}`,{signal:b.signal}),fetch(`/api/targets?targetType=AGENT&t=${a}`,{signal:b.signal})]);clearTimeout(c);let[j,k,l,m,n,o]=await Promise.all([d.json().catch(()=>({})),e.json().catch(()=>[]),f.json().catch(()=>[]),g.json().catch(()=>({data:[]})),h.json().catch(()=>[]),i.json().catch(()=>[])]),p=Array.isArray(m?.data)?m.data:Array.isArray(m)?m:[],q=Array.isArray(n)&&n.length>0?n[0]:null,r=(Array.isArray(o)?o:[]).filter(a=>"ACTIVE"===a.status),s={totalSales:r.reduce((a,b)=>a+(b.achievedValue||0),0),totalQuantity:r.reduce((a,b)=>a+(b.achievedQuantity||0),0),activeAgents:p.filter(a=>"ACTIVE"===a.status).length};C({analytics:j||{},pulse:Array.isArray(k)?k:[],shops:Array.isArray(l)?l:l.data||[],team:p,adminTarget:q,teamPerformance:s})}catch(a){"AbortError"!==a.name&&console.error("Sync Error:",a)}finally{A(!1)}},[g]);(0,c.useEffect)(()=>{if("unauthenticated"===g)w.push("/auth/signin");else if("authenticated"===g)if(a?.user?.role!=="ADMIN"&&a?.user?.role!=="SUPER_ADMIN")w.push("/mobilepos");else{I();let a=setInterval(I,3e4);return()=>clearInterval(a)}},[g,a,w,I]);let J=(0,c.useMemo)(()=>{let a=Array.isArray(B.team)?B.team.filter(a=>"ACTIVE"===a.status||a.isInsideZone).length:0,b=Array.isArray(B.team)?B.team.length:0,c=Array.isArray(B.shops)?B.shops.reduce((a,b)=>a+(b.stats?.inventory||0),0):0;return{active:a,total:b,inv:c,alertCount:Array.isArray(B.pulse)?B.pulse.filter(a=>"GHOST_ALERT"===a.type).length:0,chart:B.analytics.chartData||[]}},[B]);return"loading"===g||z?(0,b.jsx)("div",{className:"h-screen w-full flex flex-col items-center justify-center bg-slate-50",children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,b.jsx)(o.Loader2,{className:"w-8 h-8 text-primary animate-spin"}),(0,b.jsx)("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Initializing Command..."})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-slate-50 p-8 text-slate-900 font-sans",children:[(0,b.jsxs)("div",{className:"max-w-7xl mx-auto mb-6 flex justify-between items-center bg-white border border-slate-200 p-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"bg-slate-900 text-white p-2.5",children:(0,b.jsx)(d.LayoutDashboard,{size:18})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-bold text-slate-900 tracking-tight",children:"Operations Dashboard"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,b.jsx)("div",{className:"h-1 w-1 rounded-full bg-emerald-500"}),(0,b.jsxs)("p",{className:"text-[10px] font-medium text-slate-500",children:["Live • ",a?.user?.name]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex bg-slate-100 border border-slate-200",children:[(0,b.jsxs)("button",{onClick:()=>E("DATA"),className:`px-3 py-2 text-[10px] font-semibold flex items-center gap-1.5 transition-colors ${"DATA"===D?"bg-white text-slate-900":"text-slate-500 hover:text-slate-700"}`,children:[(0,b.jsx)(n,{size:12})," List"]}),(0,b.jsxs)("button",{onClick:()=>E("MAP"),className:`px-3 py-2 text-[10px] font-semibold flex items-center gap-1.5 transition-colors ${"MAP"===D?"bg-white text-slate-900":"text-slate-500 hover:text-slate-700"}`,children:[(0,b.jsx)(m.Map,{size:12})," Map"]})]}),(0,b.jsxs)("button",{onClick:I,className:"flex items-center gap-1.5 bg-slate-900 text-white hover:bg-slate-800 px-4 py-2 text-[10px] font-semibold transition-colors",children:[(0,b.jsx)(e.RefreshCcw,{size:12,className:z?"animate-spin":""})," Sync"]})]})]}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-5",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(T,{label:"Field Team",value:J.total,sub:"Registered Agents",icon:f.Users}),(0,b.jsx)(T,{label:"Active Now",value:J.active,sub:"Online Signal",icon:h,active:!0}),(0,b.jsx)(T,{label:"Inventory Level",value:J.inv.toLocaleString(),sub:"Total Units",icon:j.Package}),(0,b.jsx)(T,{label:"Security Alerts",value:J.alertCount,sub:"Req. Attention",icon:k.ShieldAlert,alert:J.alertCount>0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsx)("div",{className:"lg:col-span-3",children:(0,b.jsx)(R,{adminTarget:B.adminTarget,teamPerformance:B.teamPerformance,onRefresh:I})}),(0,b.jsx)("div",{className:"lg:col-span-2 bg-white border border-slate-200 flex flex-col relative overflow-hidden h-[580px]",children:"MAP"===D?(0,b.jsxs)("div",{className:"h-full w-full relative z-0",children:[(0,b.jsx)(S,{shops:B.shops}),(0,b.jsxs)("div",{className:"absolute top-4 left-4 z-[400] bg-white border border-slate-200 px-4 py-3",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase text-slate-500 tracking-wider",children:"Network"}),(0,b.jsxs)("p",{className:"text-sm font-bold text-slate-900",children:[B.shops.length," Active Hubs"]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"border-b border-slate-200 px-5 py-3 bg-slate-50 flex justify-between items-center",children:(0,b.jsxs)("h3",{className:"text-xs font-semibold text-slate-900 flex items-center gap-2",children:[(0,b.jsx)(l.Building2,{size:14,className:"text-slate-500"})," Hub Performance"]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,b.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,b.jsx)("thead",{className:"text-[10px] font-semibold text-slate-500 uppercase tracking-wider sticky top-0 z-10 bg-slate-50 border-b border-slate-200",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-5 py-3 border-b border-slate-100",children:"Hub Location"}),(0,b.jsx)("th",{className:"px-5 py-3 border-b border-slate-100",children:"Address"}),(0,b.jsx)("th",{className:"px-5 py-3 border-b border-slate-100 text-right",children:"Sales (Est)"}),(0,b.jsx)("th",{className:"px-5 py-3 border-b border-slate-100 text-right",children:"Status"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100 text-xs",children:B.shops.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors group",children:[(0,b.jsx)("td",{className:"px-5 py-3.5 font-semibold text-slate-900",children:a.name}),(0,b.jsx)("td",{className:"px-5 py-3.5 text-slate-500",children:a.location||"N/A"}),(0,b.jsxs)("td",{className:"px-5 py-3.5 text-right font-mono text-slate-700",children:["₵",(150*(a.stats?.inventory||0)).toLocaleString()]}),(0,b.jsx)("td",{className:"px-5 py-3.5 text-right",children:(0,b.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-emerald-50 border border-emerald-200 text-emerald-700 font-medium text-[9px]",children:[(0,b.jsx)("div",{className:"w-1 h-1 bg-emerald-500 rounded-full"}),"ONLINE"]})})]},a.id))})]})})]})}),(0,b.jsx)("div",{className:"bg-white border border-slate-200",children:(0,b.jsx)(K,{})})]}),(0,b.jsx)("div",{className:"bg-white border border-slate-200",children:(0,b.jsx)(G,{data:B.pulse})}),(0,b.jsxs)("div",{className:"bg-white border border-slate-200 h-[320px] flex flex-col overflow-hidden p-5",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-slate-900 text-white",children:(0,b.jsx)(i.Activity,{size:14})}),(0,b.jsx)("h3",{className:"text-xs font-semibold text-slate-900",children:"Sales Velocity"})]}),(0,b.jsx)("p",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider bg-slate-50 border border-slate-200 px-3 py-1",children:"Last 24 Hours"})]}),(0,b.jsx)("div",{className:"flex-1 w-full text-xs",children:(0,b.jsx)(u.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(p.BarChart,{data:J.chart,barSize:40,children:[(0,b.jsx)(s.CartesianGrid,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),(0,b.jsx)(r.XAxis,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:500,fill:"#64748b"},dy:10}),(0,b.jsx)(t.Tooltip,{cursor:{fill:"#f8fafc"},contentStyle:{borderRadius:"2px",border:"1px solid #e2e8f0",boxShadow:"0 1px 3px rgba(0,0,0,0.05)",fontSize:"11px",fontWeight:600}}),(0,b.jsx)(q.Bar,{dataKey:"sales",radius:[2,2,0,0],children:J.chart.map((a,c)=>(0,b.jsx)(v.Cell,{fill:c%2==0?"#1e293b":"#3b82f6"},`cell-${c}`))})]})})})]})]}),F&&(0,b.jsx)(V,{onClose:()=>H(!1),onSuccess:()=>{H(!1),I()},userId:a?.user?.email})]})}function V({onClose:a,onSuccess:d,userId:f}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)({targetValue:5e4,targetQuantity:500,startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+2592e6).toISOString().split("T")[0]}),k=async()=>{h(!0);try{(await fetch("/api/targets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,userId:f})})).ok&&d()}catch(a){console.error(a)}finally{h(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full animate-in zoom-in-95 relative overflow-hidden shadow-2xl",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-8 border-b border-slate-100 pb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-black text-slate-900 uppercase tracking-tight",children:"Set Leader Target"}),(0,b.jsx)("button",{onClick:a,children:(0,b.jsx)("div",{className:"p-2 bg-slate-50 text-slate-400 hover:text-rose-500 rounded-lg transition-colors",children:(0,b.jsx)(e.RefreshCcw,{className:"rotate-45",size:18})})})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1",children:"Sales Goal (GHS)"}),(0,b.jsx)("input",{type:"number",className:"nexus-input w-full text-xl font-bold",value:i.targetValue,onChange:a=>j({...i,targetValue:parseFloat(a.target.value)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1",children:"Volume Goal (Units)"}),(0,b.jsx)("input",{type:"number",className:"nexus-input w-full text-xl font-bold",value:i.targetQuantity,onChange:a=>j({...i,targetQuantity:parseInt(a.target.value)})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1",children:"Start Date"}),(0,b.jsx)("input",{type:"date",className:"nexus-input w-full",value:i.startDate,onChange:a=>j({...i,startDate:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1",children:"End Date"}),(0,b.jsx)("input",{type:"date",className:"nexus-input w-full",value:i.endDate,onChange:a=>j({...i,endDate:a.target.value})})]})]})]}),(0,b.jsx)("button",{onClick:k,className:"w-full mt-8 bg-slate-900 text-white h-12 rounded-xl font-bold uppercase tracking-widest hover:bg-black transition-all shadow-lg shadow-slate-900/10 active:scale-95 flex items-center justify-center gap-2",disabled:g,children:g?(0,b.jsx)(e.RefreshCcw,{className:"animate-spin",size:18}):"Activate Target"})]})})}a.s(["default",()=>U],40572)}];

//# sourceMappingURL=apps_admin_src_app_dashboard_page_tsx_4ecdc668._.js.map