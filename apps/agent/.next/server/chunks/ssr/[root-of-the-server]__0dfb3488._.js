module.exports=[90329,(a,b,c)=>{"use strict";b.exports=a.r(34757).vendored.contexts.HooksClientContext},27157,(a,b,c)=>{"use strict";b.exports=a.r(34757).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},29091,(a,b,c)=>{"use strict";b.exports=a.r(34757).vendored.contexts.AppRouterContext},88064,a=>{"use strict";let b=(0,a.i(25700).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],88064)},25700,a=>{"use strict";var b=a.i(89930);let c=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim(),d=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)};var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:d=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:d,height:d,stroke:a,strokeWidth:g?24*Number(f)/Number(d):f,className:c("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0;return!1})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:c(`lucide-${d(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=d(a),g};a.s(["default",()=>g],25700)},3988,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},94724,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},83090,a=>{"use strict";var b=a.i(89477),c=a.i(89930);let d=(0,c.createContext)(void 0);function e({children:a}){let[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)("blue");return(0,c.useEffect)(()=>{let a=localStorage.getItem("nexus-theme-mode"),b=localStorage.getItem("nexus-theme-accent");a&&f("dark"===a),b&&h(b)},[]),(0,c.useEffect)(()=>{localStorage.setItem("nexus-theme-mode",e?"dark":"light"),localStorage.setItem("nexus-theme-accent",g)},[e,g]),(0,b.jsx)(d.Provider,{value:{darkMode:e,toggleDarkMode:()=>f(!e),accent:g,setAccent:h,themeClasses:{bg:e?"bg-slate-900":"bg-slate-50",text:e?"text-white":"text-slate-900",card:e?"bg-slate-800":"bg-white",border:e?"border-slate-700":"border-slate-100",nav:e?"bg-slate-900/80 backdrop-blur-md":"bg-white/80 backdrop-blur-md"}},children:a})}function f(){let a=(0,c.useContext)(d);if(!a)throw Error("useMobileTheme must be used within a MobileThemeProvider");return a}a.s(["MobileThemeProvider",()=>e,"useMobileTheme",()=>f])},78352,a=>{"use strict";let b=(0,a.i(25700).default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);a.s(["Home",()=>b],78352)},67837,a=>{"use strict";let b=(0,a.i(25700).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],67837)},2807,a=>{"use strict";let b=(0,a.i(25700).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["X",()=>b],2807)},12533,a=>{"use strict";let b=(0,a.i(25700).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],12533)},58482,a=>{"use strict";let b=(0,a.i(25700).default)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);a.s(["Smartphone",()=>b],58482)},92690,a=>{"use strict";let b=(0,a.i(25700).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],92690)},69118,a=>{"use strict";let b=(0,a.i(25700).default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);a.s(["LogOut",()=>b],69118)},98845,a=>{"use strict";let b={enqueue:(a,b)=>{},getAll:()=>[],remove:a=>{},clear:()=>{},count:()=>b.getAll().length};a.s(["SyncQueue",0,b])},29370,a=>{"use strict";let b=(0,a.i(25700).default)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);a.s(["WifiOff",()=>b],29370)},77241,a=>{"use strict";let b=(0,a.i(25700).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],77241)},87307,98149,a=>{"use strict";var b=a.i(25700);let c=(0,b.default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);a.s(["Phone",()=>c],87307);let d=(0,b.default)("signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);a.s(["Signal",()=>d],98149)},12882,a=>{"use strict";let b=(0,a.i(25700).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);a.s(["MessageSquare",()=>b],12882)},28002,a=>{"use strict";let b=(0,a.i(25700).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],28002)},21084,a=>{"use strict";let b=(0,a.i(25700).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],21084)},91700,a=>{"use strict";var b=a.i(89477),c=a.i(89930),d=a.i(60942);let e=(0,c.createContext)(void 0),f="nexus_mobile_identity",g="nexus_mobile_inventory",h="nexus_mobile_last_sync",i=new Map;function j({children:a}){let[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null);(0,c.useRef)(void 0);let t=(0,c.useRef)(null),u=(0,c.useCallback)(()=>{try{let a=localStorage.getItem(f),b=localStorage.getItem(g),c=localStorage.getItem(h);if(a&&b&&c){let d=new Date(c),e=Date.now()-d.getTime();if(e<3e5){let c=JSON.parse(a),f=JSON.parse(b);return k(c),m(f),s(d),console.log(`âœ… Cache loaded (age: ${Math.round(e/1e3)}s)`),!0}console.log(`â° Cache expired (age: ${Math.round(e/1e3)}s, max: ${300}s)`)}}catch(a){console.error("Cache load failed:",a)}return!1},[]),v=(0,c.useCallback)((a,b)=>{try{let c=new Date;localStorage.setItem(f,JSON.stringify(a)),localStorage.setItem(g,JSON.stringify(b)),localStorage.setItem(h,c.toISOString()),s(c)}catch(a){console.error("Cache save failed:",a)}},[]),w=(0,c.useCallback)(async()=>{if(!j?.shopId)return;let a=`inventory-${j.shopId}`;if(i.has(a))return console.log("â© Deduplicating inventory request"),i.get(a);try{let b=fetch(`/api/inventory?shopId=${j.shopId}&t=${Date.now()}`).then(a=>{if(a.ok)return a.json();throw Error(`HTTP ${a.status}`)}).then(a=>{let b=Array.isArray(a)?a:a.data||[];return m(b),j&&v(j,b),b}).finally(()=>{i.delete(a)});i.set(a,b),await b}catch(a){console.warn("âš ï¸ Background inventory sync failed:",a.message)}},[j,v]),x=(0,c.useCallback)(async(a=!1)=>{a&&o(!0),q(null);let b="mobile-init";if(i.has(b))return console.log("â© Deduplicating init request"),i.get(b);try{console.log("ðŸ“¡ Mobile Init: Fetching assignment data...");let a=(async()=>{let a=await fetch(`/api/mobile/init?t=${Date.now()}`,{credentials:"include"});if(!a.ok){if(401===a.status)throw console.error("âŒ Mobile Init: Authentication failed"),Error("AUTH_FAILED");if(409===a.status){console.error("âŒ Mobile Init: No shop assignment"),q("NO_SHOP_ASSIGNED"),d.toast.error("No shop assigned. Contact your manager.",{duration:5e3}),o(!1);return}throw console.error(`âŒ Mobile Init: Failed with status ${a.status}`),Error("Init failed")}let b=await a.json();if(console.log("âœ… Mobile Init: Assignment data received",{shopId:b.shopId,shopName:b.shopName,hasGPS:!!(b.shopLat&&b.shopLng)}),!b.shopId){console.error("âŒ Mobile Init: Response missing shopId"),q("NO_SHOP_ASSIGNED"),d.toast.error("Invalid shop assignment. Please contact support.",{duration:5e3}),o(!1);return}let c={id:b.id,agentName:b.agentName,agentImage:b.agentImage,shopId:b.shopId,shopName:b.shopName,managerName:b.managerName,managerPhone:b.managerPhone,shopLat:b.shopLat,shopLng:b.shopLng,radius:b.radius||100,targetProgress:b.targetProgress,bypassGeofence:b.bypassGeofence,lockout:b.lockout};t.current&&t.current!==b.shopId&&(console.log(`ðŸ”„ Shop Reassignment Detected: ${t.current} â†’ ${b.shopId}`),d.toast.success(`ðŸ”„ Reassigned to ${b.shopName}`,{duration:3e3}),m([])),t.current=b.shopId,k(c),console.log(`ðŸ“¦ Fetching inventory for shop: ${b.shopId}`);let e=await fetch(`/api/inventory?shopId=${b.shopId}&t=${Date.now()}`);if(e.ok){let a=await e.json(),b=Array.isArray(a)?a:a.data||[];console.log(`âœ… Inventory loaded: ${b.length} items`),m(b),v(c,b)}else console.warn("âš ï¸ Inventory fetch failed:",e.status),m([]),v(c,[])})().finally(()=>{i.delete(b),o(!1)});i.set(b,a),await a}catch(b){console.error("âŒ Mobile Data Sync Error:",b);let a="Connection error";"AUTH_FAILED"===b.message?(a="AUTH_FAILED",d.toast.error("Session expired. Please login again.",{duration:5e3})):b.message?.includes("fetch")||b.message?.includes("Failed to fetch")?(a="Network connection lost. Please check your internet.",d.toast.error("Network error. Retrying...",{duration:3e3})):b.message?.includes("timeout")?(a="Request timeout. Slow connection detected.",d.toast.error("Connection timeout. Please try again.",{duration:3e3})):d.toast.error("Sync failed. Pull to refresh.",{duration:3e3}),q(a),o(!1)}},[v]),y=(0,c.useCallback)((a,b)=>{m(c=>c.map(c=>c.id===a?{...c,...b}:c))},[]);return(0,c.useEffect)(()=>{let a;u()?(o(!1),x(!1)):x(!0);let b=12e4,c=()=>{a&&clearInterval(a),a=setInterval(()=>{w()},b)},d=()=>{document.hidden?(console.log("ðŸ“´ Tab hidden - reducing sync frequency"),b=6e5):(console.log("ðŸ“± Tab active - increasing sync frequency"),b=12e4,w()),c()};return document.addEventListener("visibilitychange",d),c(),()=>{a&&clearInterval(a),document.removeEventListener("visibilitychange",d)}},[u,x,w]),(0,b.jsx)(e.Provider,{value:{identity:j,inventory:l,loading:n,error:p,refreshData:x,refreshInventory:w,updateInventoryItem:y,lastSync:r},children:a})}function k(){let a=(0,c.useContext)(e);if(void 0===a)throw Error("useMobileData must be used within MobileDataProvider");return a}a.s(["MobileDataProvider",()=>j,"useMobileData",()=>k])},91498,a=>{"use strict";let b=(0,a.i(25700).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);a.s(["AlertTriangle",()=>b],91498)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0dfb3488._.js.map