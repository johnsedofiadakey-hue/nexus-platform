module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},21517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},6461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},24836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},27699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},63021,(e,t,r)=>{t.exports=e.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},69236,e=>{"use strict";var t=e.i(63021);let r=e.g,n=function(){if(r.prisma)return r.prisma;if(!process.env.DATABASE_URL)return new t.PrismaClient({log:[]});let e=process.env.DATABASE_URL,n=e.includes("?")?`${e}&pgbouncer=true&connection_limit=1`:`${e}?pgbouncer=true&connection_limit=1`;return new t.PrismaClient({datasources:{db:{url:n}},log:["error"]})}();e.s(["prisma",0,n])},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},18285,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},98148,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={};Object.defineProperty(r,"default",{enumerable:!0,get:function(){return s.default}});var a=e.r(18285);Object.keys(a).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in r&&r[e]===a[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}})});var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&({}).hasOwnProperty.call(e,s)){var o=a?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}(e.r(44257));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}})})},34428,e=>{"use strict";var t=e.i(69236);async function r(e){try{await t.prisma.activityLog.create({data:{userId:e.userId,userName:e.userName,userRole:e.userRole,action:e.action,entity:e.entity,entityId:e.entityId,description:e.description,metadata:e.metadata||{},ipAddress:e.ipAddress,userAgent:e.userAgent,shopId:e.shopId,shopName:e.shopName}})}catch(e){console.error("❌ Activity Logger Error:",e)}}async function n(e,r,n,a,s,i,o,l,u){try{await t.prisma.targetHistory.create({data:{targetId:e,userId:r,action:n,previousValue:a||{},newValue:s||{},progress:i||0,achievedValue:o||0,achievedQuantity:l||0,notes:u}})}catch(e){console.error("❌ Target History Logger Error:",e)}}function a(e){let t=e.headers.get("x-forwarded-for"),r=e.headers.get("x-real-ip");return t?t.split(",")[0].trim():r||void 0}function s(e){return e.headers.get("user-agent")||void 0}e.s(["getClientIp",()=>a,"getUserAgent",()=>s,"logActivity",()=>r,"logTargetActivity",()=>n])},71003,e=>{"use strict";var t=e.i(98148),r=e.i(89455),n=e.i(52716);async function a(){let e=await (0,t.getServerSession)(r.authOptions);return e?.user?.email?{id:e.user.id||"",email:e.user.email,name:e.user.name||null,role:e.user.role||"WORKER",organizationId:e.user.organizationId||null}:null}async function s(){let e=await a();if(!e)throw Error("UNAUTHORIZED");return e}function i(e){return(console.error("API Error:",e),"UNAUTHORIZED"===e.message)?n.NextResponse.json({error:"Unauthorized - Please sign in"},{status:401}):"FORBIDDEN"===e.message?n.NextResponse.json({error:"Forbidden - Insufficient permissions"},{status:403}):"NO_ORGANIZATION"===e.message?n.NextResponse.json({error:"No organization assigned"},{status:400}):n.NextResponse.json({error:"Internal server error"},{status:500})}e.s(["handleApiError",()=>i,"requireAuth",()=>s])},68652,e=>{"use strict";var t=e.i(36674),r=e.i(41118),n=e.i(59617),a=e.i(52171),s=e.i(43408),i=e.i(67620),o=e.i(82397),l=e.i(27688),u=e.i(75897),d=e.i(96582),c=e.i(64108),p=e.i(18505),h=e.i(84130),f=e.i(26866),m=e.i(77048),g=e.i(93695);e.i(3348);var x=e.i(76390),R=e.i(52716),v=e.i(69236),y=e.i(98954),w=e.i(71003),E=e.i(34428);async function b(e){try{let t=await (0,w.requireAuth)(),{name:r,email:n,password:a,role:s,phone:i,ghanaCard:o,dob:l,shopId:u,image:d,bankAccountName:c,bankName:p,bankAccountNumber:h,ssnitNumber:f,commencementDate:m}=await e.json(),g=t.organizationId;if(u){let e=await v.prisma.shop.findUnique({where:{id:u},select:{organizationId:!0}});if(!e)return R.NextResponse.json({error:"Operational Hub not found."},{status:404});if("SUPER_ADMIN"!==t.role&&e.organizationId!==t.organizationId)return R.NextResponse.json({error:"Access Denied: You do not have authority over this hub."},{status:403});g=e.organizationId}if(!g)return R.NextResponse.json({error:"Organization Context Required: Please assign a hub or ensure your profile is linked to an organization."},{status:400});if(!n||!a||!r)return R.NextResponse.json({error:"Incomplete Identity: Name, email, and access key are mandatory."},{status:400});let x=n.toLowerCase().trim();if(await v.prisma.user.findUnique({where:{email:x}}))return R.NextResponse.json({error:"Collision Detected: This email is already active in the network."},{status:409});let b=await y.default.hash(a,12),A=null;if(l){let e=new Date(l);isNaN(e.getTime())||(A=e)}let N=null;if(m){let e=new Date(m);isNaN(e.getTime())||(N=e)}let I=await v.prisma.user.create({data:{organization:{connect:{id:g}},name:r.trim(),email:x,password:b,role:s||"WORKER",phone:i||null,ghanaCard:o||null,dob:A,image:d||null,bankAccountName:c||null,bankName:p||null,bankAccountNumber:h||null,ssnitNumber:f||null,commencementDate:N,status:"ACTIVE",shop:u?{connect:{id:u}}:void 0},select:{id:!0,name:!0,email:!0,role:!0,status:!0,shopId:!0,shop:{select:{name:!0}}}});return console.log(`✅ Uplink Established: ${I.name} assigned to hub ${I.shop?.name||"Mobile"}`),await (0,E.logActivity)({userId:t.id,userName:t.name||"Unknown",userRole:t.role||"USER",action:"USER_CREATED",entity:"User",entityId:I.id,description:`Created new user "${I.name}" with role ${I.role}`,metadata:{newUserId:I.id,newUserEmail:I.email,newUserRole:I.role,shopId:I.shopId},ipAddress:(0,E.getClientIp)(e),userAgent:(0,E.getUserAgent)(e),shopId:I.shopId||void 0,shopName:I.shop?.name||void 0}),R.NextResponse.json({message:"Operative enrolled successfully",user:I},{status:201})}catch(e){if(console.error("❌ ENROLLMENT_ENGINE_CRITICAL_FAILURE:",e),"UNAUTHORIZED"===e.message||"FORBIDDEN"===e.message)return(0,w.handleApiError)(e);if("PrismaClientValidationError"===e.name)return R.NextResponse.json({error:"Schema Mismatch: The database does not recognize some provided fields.",details:"Action: Run 'npx prisma db push' to sync your database."},{status:500});if("P2002"===e.code)return R.NextResponse.json({error:"Duplicate identity data found."},{status:400});return R.NextResponse.json({error:"Database Rejection: System failed to save operative credentials.",details:e.message},{status:500})}}e.s(["POST",()=>b],45726);var A=e.i(45726);let N=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/hr/create/route",pathname:"/api/hr/create",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/agent/src/app/api/hr/create/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:I,workUnitAsyncStorage:O,serverHooks:C}=N;function j(){return(0,n.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:O})}async function P(e,t,n){N.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/hr/create/route";R=R.replace(/\/index$/,"")||"/";let v=await N.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:y,params:w,nextConfig:E,parsedUrl:b,isDraftMode:A,prerenderManifest:I,routerServerContext:O,isOnDemandRevalidate:C,revalidateOnlyGenerated:j,resolvedPathname:P,clientReferenceManifest:_,serverActionsManifest:T}=v,U=(0,o.normalizeAppPath)(R),k=!!(I.dynamicRoutes[U]||I.routes[P]),q=async()=>((null==O?void 0:O.render404)?await O.render404(e,t,b,!1):t.end("This page could not be found"),null);if(k&&!A){let e=!!I.routes[P],t=I.dynamicRoutes[U];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await q();throw new g.NoFallbackError}}let D=null;!k||N.isDev||A||(D="/index"===(D=P)?"/":D);let S=!0===N.isDev||!k,M=k&&!S;T&&_&&(0,i.setManifestsSingleton)({page:R,clientReferenceManifest:_,serverActionsManifest:T});let H=e.method||"GET",z=(0,s.getTracer)(),L=z.getActiveScopeSpan(),$={params:w,prerenderManifest:I,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:S,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,a)=>N.onRequestError(e,t,n,a,O)},sharedContext:{buildId:y}},F=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),B=u.NextRequestAdapter.fromNodeNextRequest(F,(0,u.signalFromNodeResponse)(t));try{let i=async e=>N.handle(B,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=z.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${H} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${R}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!o&&C&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(a);e.fetchMetrics=$.renderOpts.fetchMetrics;let l=$.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=$.renderOpts.collectedTags;if(!k)return await (0,p.sendResponse)(F,K,s,$.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[m.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,n=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await N.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:C})},!1,O),t}},d=await N.handleResponse({req:e,nextConfig:E,cacheKey:D,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:I,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:j,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:o});if(!k)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",C?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&k||g.delete(m.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,f.getCacheControlHeader)(d.cacheControl)),await (0,p.sendResponse)(F,K,new Response(d.value.body,{headers:g,status:d.value.status||200})),null};L?await l(L):await z.withPropagatedContext(e.headers,()=>z.trace(d.BaseServerSpan.handleRequest,{spanName:`${H} ${R}`,kind:s.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await N.onRequestError(e,t,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:C})},!1,O),k)throw t;return await (0,p.sendResponse)(F,K,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>j,"routeModule",()=>N,"serverHooks",()=>C,"workAsyncStorage",()=>I,"workUnitAsyncStorage",()=>O],68652)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__cda0e163._.js.map